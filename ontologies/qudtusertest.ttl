@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix qudt: <http://qudt.org/schema/qudt/> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

qudt:DeprecatedPropertyConstraint a sh:NodeShape ;
    rdfs:label "Warning about use of a deprecated QUDT property" ;
    rdfs:isDefinedBy <http://qudt.org/2.1/collection/usertest> ;
    sh:severity sh:Info ;
    sh:sparql [ a sh:SPARQLConstraint ;
            rdfs:comment "Warns if a deprecated QUDT property is used" ;
            sh:message "Resource, '{$this}' uses the property '{?oldpstr}' which will be deprecated. Please use '{?newpstr}' instead." ;
            sh:prefixes <http://qudt.org/2.1/collection/usertest> ;
            sh:select """SELECT $this ?p ?oldpstr ?newpstr
WHERE {
?p qudt:deprecated true .
?p a rdf:Property .
$this ?p ?o .
?p dcterms:isReplacedBy ?newp .
BIND (STR(?newp) AS ?newpstr)
BIND (STR(?p) AS ?oldpstr)
}""" ] ;
    sh:targetClass qudt:Concept .

qudt:DeprecationConstraint a sh:NodeShape ;
    rdfs:label "Warning about use of a deprecated QUDT resource" ;
    rdfs:isDefinedBy <http://qudt.org/2.1/collection/usertest> ;
    sh:severity sh:Info ;
    sh:sparql [ a sh:SPARQLConstraint ;
            rdfs:comment "Warns if a deprecated QUDT resource is used" ;
            sh:message "Resource, '{?s}' refers to '{?oldqstr}' which has been deprecated. Please refer to '{?newqstr}' instead." ;
            sh:prefixes <http://qudt.org/2.1/collection/usertest> ;
            sh:select """SELECT ?s $this ?oldqstr ?newqstr
WHERE {
$this qudt:deprecated true .
?s ?p $this .
FILTER (!STRSTARTS(STR(?s),'http://qudt.org')) .
$this dcterms:isReplacedBy ?newq .
BIND (STR(?newq) AS ?newqstr)
BIND (STR($this) AS ?oldqstr)
}""" ] ;
    sh:targetClass qudt:Concept .

<http://qudt.org/2.1/collection/usertest> a owl:Ontology ;
    rdfs:label "QUDT Collection - USER TESTS - v 2.1.37" ;
    rdfs:isDefinedBy <http://qudt.org/2.1/collection/usertest> ;
    sh:declare [ a sh:PrefixDeclaration ;
            sh:namespace "http://purl.org/dc/terms/"^^xsd:anyURI ;
            sh:prefix "dcterms" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://www.w3.org/ns/shacl#"^^xsd:anyURI ;
            sh:prefix "sh" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://www.w3.org/2001/XMLSchema#"^^xsd:anyURI ;
            sh:prefix "xsd" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://qudt.org/schema/qudt/"^^xsd:anyURI ;
            sh:prefix "qudt" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://qudt.org/vocab/dimensionvector/"^^xsd:anyURI ;
            sh:prefix "qkdv" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://qudt.org/vocab/quantitykind/"^^xsd:anyURI ;
            sh:prefix "quantitykind" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://qudt.org/vocab/unit/"^^xsd:anyURI ;
            sh:prefix "unit" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://www.w3.org/1999/02/22-rdf-syntax-ns#"^^xsd:anyURI ;
            sh:prefix "rdf" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://www.w3.org/2000/01/rdf-schema#"^^xsd:anyURI ;
            sh:prefix "rdfs" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://www.w3.org/2002/07/owl#"^^xsd:anyURI ;
            sh:prefix "owl" ],
        [ a sh:PrefixDeclaration ;
            sh:namespace "http://www.w3.org/2004/02/skos/core#"^^xsd:anyURI ;
            sh:prefix "skos" ] .

